<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Datos del Concursante</title>
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="styles.css" rel="stylesheet">
</head>
<body>

  <div class="container">
    <div class="text-center mb-4">
      <h2>Datos del Concursante</h2>
      <p class="text-muted">Paso 1 de 3</p>
    </div>

    <!-- Formulario -->
    <form id="datos-form">
      <div class="row g-3">
        <div class="col-md-6">
          <label for="cedula" class="form-label">Cédula</label>
          <input type="text" class="form-control" id="cedula" required placeholder="12345678">
        </div>
        <div class="col-md-6">
          <label for="nombre" class="form-label">Nombre completo</label>
          <input type="text" class="form-control" id="nombre" required placeholder="Nombre y Apellido">
        </div>
        <div class="col-md-6">
          <label for="correo" class="form-label">Correo electrónico</label>
          <input type="email" class="form-control" id="correo" required placeholder="tucorreo@dominio.com">
        </div>
        <div class="col-md-6">
          <label for="telefono" class="form-label">Teléfono</label>
          <input type="tel" class="form-control" id="telefono" required placeholder="0412XXXXXXX">
        </div>
      </div>

      <!-- Métodos de Pago -->
      <div class="mt-4">
        <h5>Métodos de Pago</h5>
        <div class="row g-2">
          <div class="col-4">
            <div class="payment-method" data-method="mercantil">
              <img src="pago.png" alt="Mercantil" class="mb-2">
              <div>Pago Móvil Mercantil</div>
            </div>
          </div>
          <div class="col-4">
            <div class="payment-method" data-method="zelle">
              <img src="zelle.png" alt="Zelle" class="mb-2">
              <div>Zelle</div>
            </div>
          </div>
          <div class="col-4">
            <div class="payment-method" data-method="binance">
              <img src="binance.png" alt="Binance" class="mb-2">
              <div>Binance</div>
            </div>
          </div>
        </div>
        <input type="hidden" id="selected-method" value="">
      </div>

      <!-- Monto Total -->
      <div class="alert alert-warning mt-3" id="monto-total">
        Cargando...
      </div>

      <!-- Botones -->
      <div class="d-grid gap-2 mt-4">
        <button type="submit" class="btn btn-primary">→ Siguiente</button>
        <a href="index.html" class="btn btn-danger">Volver</a>
      </div>
    </form>
  </div>

  <!-- Bootstrap JS + Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // === Cargar datos desde localStorage ===
    const qty = parseInt(localStorage.getItem('rifa_qty')) || 1;
    const priceBs = parseFloat(localStorage.getItem('rifa_price_bs')) || 0;
    const priceUsd = parseFloat(localStorage.getItem('rifa_price_usd')) || 0;

    // Calcular monto total
    const totalBs = qty * priceBs;
    const totalUsd = qty * priceUsd;

    // Mostrar monto
    document.getElementById('monto-total').innerHTML = `
      <strong>Monto:</strong> ${totalBs.toLocaleString('es-VE', { minimumFractionDigits: 2 })} Bs.
      <br><small>(≈ ${totalUsd.toFixed(2)} USD)</small>
    `;

    // === Seleccionar método de pago ===
    let selectedMethod = '';
    document.querySelectorAll('.payment-method').forEach(method => {
      method.addEventListener('click', () => {
        document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('selected'));
        method.classList.add('selected');
        selectedMethod = method.getAttribute('data-method');
        document.getElementById('selected-method').value = selectedMethod;
      });
    });

    // === Enviar formulario ===
    document.getElementById('datos-form').addEventListener('submit', function(e) {
      e.preventDefault();

      // Validar campos
      const cedula = document.getElementById('cedula').value.trim();
      const nombre = document.getElementById('nombre').value.trim();
      const correo = document.getElementById('correo').value.trim();
      const telefono = document.getElementById('telefono').value.trim();

      if (!cedula || !nombre || !correo || !telefono) {
        alert('Por favor, completa todos los campos.');
        return;
      }

      if (!selectedMethod) {
        alert('Por favor, selecciona un método de pago.');
        return;
      }

      // Guardar datos en localStorage
      localStorage.setItem('rifa_cedula', cedula);
      localStorage.setItem('rifa_nombre', nombre);
      localStorage.setItem('rifa_correo', correo);
      localStorage.setItem('rifa_telefono', telefono);
      localStorage.setItem('rifa_metodo_pago', selectedMethod);
      localStorage.setItem('rifa_total_bs', totalBs);
      localStorage.setItem('rifa_total_usd', totalUsd);

      // Redirigir a paso 2
      window.location.href = 'paso2.html';
    });
  </script>
</body>
</html>
